<template>
    <div>
        <Nuxt />
    </div>
</template>

<script>
import supportedLanguages from '~/lang/lang.js';

export default {
    mixins: [supportedLanguages],
    mounted() {
        if( !localStorage.getItem('lang') ) {
            let lang = window.navigator.languages ? window.navigator.languages[0] : null
            lang = lang ||
                window.navigator.language ||
                window.navigator.browserLanguage ||
                window.navigator.userLanguage

            let shortLang = lang
            if (shortLang.indexOf('-') !== -1) shortLang = shortLang.split('-')[0]

            let langToChange = 'en';
            if (this.supportedLanguages.includes(shortLang)) {
                langToChange = shortLang;
            } else if (this.supportedLanguages.includes(lang)) {
                langToChange = lang;
            }

            this.$i18n.locale = langToChange;
            localStorage.setItem('lang', langToChange);
        }
        else {
            this.$i18n.locale = localStorage.getItem('lang');
        }
    },
}
</script>
